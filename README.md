Nesta tarefa foram implementadas duas classes em java: Server.java e Client.java.
Nesse projeto, o servidor continua executando suas atividades mesmo quando o cliente é desconectado. Desta forma, o servidor possui condições de atender a mais de um cliente, porém, o servidor consegue atender apenas um cliente por vez. Quando um cliente se desconecta da comunicação, outro cliente pode se conectar.
O sistema de preço propriamente dito, está implementado no servidor. O programa do cliente, apenas realiza solicitações de pesquisa e informa dados que serão salvos no banco de dados do servidor.
O servidor armazena as informações de cada posto de combustível, num arquivo correspondente a ele. Ou seja, cada posto de combustível possui um arquivo do tipo txt, onde o nome de cada arquivo é Posto: x,y, onde x corresponde à posição da latitude e o y corresponde à posição da longitude daquele posto de combustível em questão. No arquivo são armazenadas as seguintes informações: localização do posto (latitude e longitude) e os preços ofertados de cada combustível comercializado naquele respectivo posto de combustível: preço do diesel, preço do álcool e preço da gasolina.
Quando o cliente efetua a entrada de um dado referente a um posto de combustível, a informação é atualizada no arquivo (caso o posto de combustível já possua registro no banco de dados).
Caso o posto de combustível informado não possua registro, o servidor criará um arquivo para o posto em questão, e armazenará a informação que lhe foi passada sobre um determinado preço de um determinado tipo de combustível do posto de combustível em questão. As demais informações de preços dos outros tipos de combustível, são inicialmente escritas no arquivo como desconhecidas, até que o cliente informe, qual o preço dos outros tipos de combustível daquele determinado posto de combustível.
Quando o cliente efetua uma pesquisa, o servidor irá realizar uma busca nos postos de combustível que estão dentro do raio de busca informado pelo cliente. Neste processo, o servidor utiliza o ponto central da circunferência, onde é extraída a informação de latitude e longitude do centro da circunferência de pesquisa. O ponto de partida da busca, é o valor das coordenadas do ponto central menos o raio de busca, ou seja, o valor da latitude do centro menos o raio e o valor da longitude do centro menos o raio. Por meio deste ponto de partida, o servidor calcula a distância entre este ponto de partida e o centro de busca. Caso a distância seja superior ao valor do raio de busca, isso indica que o ponto calculado está fora da circunferência, desta forma, incrementa-se o valor da latitude até que a distância seja menor ou igual ao raio de busca. Quando a distância for igual ao raio de busca, isso indica que o ponto se encontra na borda da circunferência de busca, e este ponto também é considerado como “dentro do raio de busca”. Caso a distância calculada seja inferior ao raio de busca, isso indica que o ponto está dentro da circunferência de busca.
Desta forma, enquanto a distância entre o ponto atual e o centro de busca for menor ou igual ao raio, é feita uma busca se há algum posto de combustível com as coordenadas daquele determinado ponto. Caso exista algum posto de combustível registrado no banco de dados com essa coordenada, as coordenadas deste posto são extraídas do arquivo, com o intuito de identificar o posto, além disso, é extraído o valor correspondente ao tipo de combustível que o cliente solicitou na pesquisa.
O servidor retorna ao cliente as informações da localização do posto de combustível (latitude e longitude) que possui o menor preço do tipo de combustível solicitado, e retorna o valor do combustível em questão. Caso haja mais de um posto de combustível que contém o mesmo preço para um determinado tipo de combustível e este preço for o menor preço dentre os demais, todos estes postos de combustíveis contendo o menor valor, serão informados ao cliente.
Caso todos os postos de combustíveis encontrados dentro da região definida pelo cliente, não possuírem valores conhecidos dos preços do determinado tipo de combustível desejado para ser buscado o menor preço dentre eles, o servidor informará ao cliente que: “Não foram encontrados postos de combustível com preços conhecidos sobre este tipo de combustível”
Caso não sejam encontrados postos de combustíveis cadastrados dentro da região informada pelo cliente, o servidor informará ao cliente que: “Não foram encontrados postos de combustível dentro de um raio de x”, onde x se refere ao valor do raio informado pelo cliente.

A entrada do programa do cliente é composta por uma String, onde o cliente deve digitar P (para pesquisar um menor preço de um determinado tipo de combustível) ou D (para informar um dado sobre um posto específico), um número inteiro correspondendo ao identificador da mensagem, um valor entre 0 e 2 no qual: 0 corresponde a diesel, 1 corresponde a álcool, e 2 corresponde a gasolina.
Na entrada de dados (D), é informado um valor correspondendo ao preço daquele tipo de combustível comercializado pelo posto de combustível correspondente, e os valores de latitude e longitude, indicando o posicionamento de onde aquele posto de combustível em questão se encontra. Cada informação é separada uma da outra por meio de um espaço em branco.
Exemplo de entrada de dado, cujo identificador da mensagem é 789 para efetuar a entrada de um diesel, de valor R$ 3.678, e coordenadas do posto de combustível correspondente a 1789 (latitude) e 4568 (longitude):

    • D 789 0 3678 1789 4568

No caso da pesquisa (P), é informado também o raio de busca, juntamente com os valores de latitude e longitude do ponto central.
Exemplo de uma pesquisa de menor preço, cujo identificador da mensagem é 57 para pesquisar o preço da gasolina, dentro de um raio de valor 100, cuja coordenada do centro de pesquisa corresponde a 590 (latitude) 863 (longitude):

    • P 57 2 100 590 863

Informações mais detalhadas sobre o funcionamento dos programas do servidor e do cliente, encontram-se nos comentários inclusos nos códigos apresentados.
